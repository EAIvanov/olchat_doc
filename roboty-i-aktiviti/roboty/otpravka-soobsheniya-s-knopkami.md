# Отправка сообщения с кнопками

{% hint style="danger" %}
Данный функционал временно не работает. Техотдел ищет решение.
{% endhint %}

{% hint style="warning" %}
Это экспериментальный функционал. Мы не гарантируем его стабильную работу и не можем гарантировать, что WhatsApp не заблокирует эту возможность. Но пока можно пользоваться и получать восторженные отзывы клиентов при работе с уникальным функционалом.
{% endhint %}

### Настройка робота

Для отправки сообщения с кнопками добавьте робота «\[OLChat] WhatsApp Отправка сообщения с кнопками». Для этого перейдите в **Роботы ‒ Создать ‒ Выбор стадии ‒ Другие роботы ‒ \[OLChat] WhatsApp Отправка сообщения с кнопками ‒ Добавить.**

<figure><img src="../../.gitbook/assets/image (714).png" alt=""><figcaption></figcaption></figure>

Выполните настройку робота. Для этого на добавленном роботе нажмите на кнопку «изменить», чтобы открыть интерфейс редактирования робота:

1. Укажите **Линию WhatsApp,** через которую планируете сделать отправку
2. Введите **Номер телефона**, на который необходимо отправить сообщение
3. В поле **«Заголовок»** укажите текст, который будет являться заголовком сообщения длиной не более 60 символов
4. В поле **«Сообщение»** укажите текст сообщения
5. В поле **«Подпись»** укажите текст, который будет являться подписью сообщения. Длина не более 60 символов
6. В полях **«Кнопка 1», «Кнопка 2», «Кнопка 3»** укажите текст, который будет выведен на кнопках в сообщении. Ограничение длины текста – 20 символов
7. В поле **«Ожидать ответ сообщения»** выберете **«Да»,** если хотите дождаться ответа пользователя и использовать его выбор кнопки в дальнейших сценариях автоматизации или **«Нет»,** если в этом нет необходимости

Остальные настройки можно оставить по умолчанию. Нажмите на кнопку «СОХРАНИТЬ»

![](<../../.gitbook/assets/image (871).png>)

{% hint style="info" %}
Если в настройках робота в поле **«Ожидать ответ сообщения»** вы выбрали **«Да»,** следует помнить об особенностях функционирования роботов. Чтобы дождаться ответа пользователя и использовать его выбор кнопки в дальнейших сценариях автоматизации, статус или стадия сущности в которой запущен робот не должна изменятся! При перемещении на другую стадию робот завершит свою работу и не среагирует на ответ пользователя.

Если вы хотите получать ответ пользователя вне зависимости от статусов или стадий – используйте функционал бизнес-процессов, описанный в разделе[#nastroika-aktiviti-deistviya-biznes-processa](otpravka-soobsheniya-s-knopkami.md#nastroika-aktiviti-deistviya-biznes-processa "mention")
{% endhint %}

### Настройка активити (действия) бизнес-процесса

{% embed url="https://youtu.be/h21limiMbfc" %}

<figure><img src="../../.gitbook/assets/image (2) (1).png" alt=""><figcaption></figcaption></figure>

Для отправки сообщения с кнопками из бизнес-процесса добавьте действие «Отправка сообщения с кнопками». Выполните настройку параметров действия:

1. Укажите **Линию WhatsApp,** через которую планируете сделать отправку
2. Введите **Номер телефона**, на который необходимо отправить сообщение
3. В поле **«Заголовок»** укажите текст, который будет являться заголовком сообщения длиной не более 60 символов
4. В поле **«Сообщение»** укажите текст сообщения
5. В поле **«Подпись»** укажите текст, который будет являться подписью сообщения. Длина не более 60 символов
6. В полях **«Кнопка 1», «Кнопка 2», «Кнопка 3»** укажите текст, который будет выведен на кнопках в сообщении. Ограничение длины текста – 20 символов
7. В поле **«Ожидать ответ сообщения»** выберете **«Да»,** если хотите дождаться ответа пользователя и использовать его выбор кнопки в дальнейших сценариях автоматизации или **«Нет»,** если в этом нет необходимости

![](<../../.gitbook/assets/image (116).png>)

Остальные настройки можно оставить по умолчанию.

Если в поле **«Ожидать ответ сообщения»** вы выбрали **«Да»,** ответ пользователя (выбранную им кнопку) можно получить в дополнительных результатах активити «\[OLChat] WhatsApp - Отправка сообщения с кнопками».

![](<../../.gitbook/assets/image (80).png>)

Используя данную возможность, можно организовать работу простого чат-бота в WhatsApp. С помощью условий задаётся логическая последовательность действий, как именно реагировать на ответ пользователя.

![](<../../.gitbook/assets/image (230).png>)

В настройках условия в качестве источника необходимо выбирать ответ пользователя, содержащий текст одной из кнопок.

<figure><img src="../../.gitbook/assets/image (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

{% hint style="success" %}
Следует помнить о том, что для одной сущности вы можете запустить не более 2-х бизнес-процессов одновременно. Подробнее в статье от Битрикс24 [Ограничение на запуск процессов](https://helpdesk.bitrix24.ru/open/5671433/)
{% endhint %}

{% hint style="info" %}
Сообщение, отправленное роботом или активити в WhatsApp имеет такой вид:
{% endhint %}

![](<../../.gitbook/assets/image (79).png>)
