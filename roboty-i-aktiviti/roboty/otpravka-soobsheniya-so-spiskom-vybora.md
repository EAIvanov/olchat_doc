# Отправка сообщения со списком выбора

{% hint style="danger" %}
Данный функционал временно не работает. Техотдел ищет решение.
{% endhint %}

### Настройка робота

Чтобы отправить сообщение со списком выбора добавьте робота «\[OLChat — Чаты и Группы WhatsApp] Отправка сообщения со списком выбора». Для этого перейдите в **Роботы ‒ Создать ‒ Выбор стадии ‒ Другие роботы ‒ \[OLChat — Чаты и Группы WhatsApp] Отправка сообщения со списком выбора ‒ Добавить.** Робот позволяет сформировать и отправить сообщение с заголовком, текстом сообщения, подписью и списком значений с возможностью выбрать значение.

<figure><img src="../../.gitbook/assets/image (416).png" alt=""><figcaption></figcaption></figure>

Выполните настройку робота. Для этого на добавленном роботе нажмите на кнопку «изменить», чтобы открыть интерфейс редактирования робота:

1. Укажите **Линию WhatsApp,** через которую планируете сделать отправку
2. Введите **Номер телефона**, на который необходимо отправить сообщение
3. В поле **«Заголовок»** укажите текст, который будет являться заголовком сообщения длиной не более 60 символов
4. В поле **«Сообщение»** укажите текст сообщения
5. В поле **«Подпись»** укажите текст, который будет являться подписью сообщения. Длина не более 60 символов
6. В поле **«Название списка»** укажите текст, который будет являться названием списка выбора
7.  В поле **«Элементы списка»** необходимо создать структуру будущего списка. Нажмите на кнопку **«Добавить»** чтобы добавить новые строки для ввода данных.\
    Пункты меню имеют особый формат.\
    Знак **«#»** в начале строки определяет Категорию с входящими в неё подпунктами. Все строки добавленные ниже определяют подпункты Категории.\
    Знак **«|»** разделяет название пункта и его описание.\
    Готовая структура может выглядеть, например, так:

    ```
    #Категория 1
    Пункт 1.1|Описание пункта 1.1
    Пункт 1.2|Описание пункта 1.2
    Пункт 1.3|Описание пункта 1.3
    #Категория 2
    Пункт 2.1|Описание пункта 2.1
    Пункт 2.2|Описание пункта 2.2
    Пункт 2.3|Описание пункта 2.3
    #Категория 3
    Пункт 3.1|Описание пункта 3.1
    Пункт 3.2|Описание пункта 3.2
    Пункт 3.3|Описание пункта 3.3
    ```
8. В поле **«Ожидать ответ сообщения»** выберите **«Да»,** если хотите дождаться ответа пользователя и использовать его выбор значения списка в дальнейших сценариях автоматизации или **«Нет»,** если в этом нет необходимости

Остальные настройки можно оставить по умолчанию. Нажмите на кнопку «СОХРАНИТЬ»

<figure><img src="../../.gitbook/assets/image (828).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../.gitbook/assets/image (397).png" alt=""><figcaption></figcaption></figure>

{% hint style="info" %}
Если в настройках робота в поле **«Ожидать ответ сообщения»** вы выбрали **«Да»,** следует помнить об особенностях функционирования роботов. Чтобы дождаться ответа пользователя и использовать его выбор элемента списка в дальнейших сценариях автоматизации, статус или стадия сущности в которой запущен робот не должна изменятся! При перемещении на другую стадию робот завершит свою работу и не среагирует на ответ пользователя.

Если вы хотите получать ответ пользователя вне зависимости от статусов или стадий – используйте функционал бизнес-процессов, описанный в разделе [#nastroika-aktiviti-deistviya-biznes-processa](otpravka-soobsheniya-so-spiskom-vybora.md#nastroika-aktiviti-deistviya-biznes-processa "mention")
{% endhint %}

### Настройка активити (действия) бизнес-процесса

Активити «Отправка сообщения со списком выбора» позволяет сформировать и отправить сообщение с заголовком, текстом сообщения, подписью и списком значений с возможностью выбрать значение.

<figure><img src="../../.gitbook/assets/image (53).png" alt=""><figcaption></figcaption></figure>

Для отправки сообщения со списком выбора из бизнес-процесса добавьте действие «Отправка сообщения со списком выбора». Выполните настройку параметров действия:

1. Укажите **Линию WhatsApp,** через которую планируете сделать отправку
2. Введите **Номер телефона**, на который необходимо отправить сообщение
3. В поле **«Заголовок»** укажите текст, который будет являться заголовком сообщения длиной не более 60 символов
4. В поле **«Сообщение»** укажите текст сообщения
5. В поле **«Подпись»** укажите текст, который будет являться подписью сообщения. Длина не более 60 символов
6. В поле **«Название списка»** укажите текст, который будет являться названием списка выбора
7.  В поле **«Элементы списка»** необходимо создать структуру будущего списка. Нажмите на кнопку **«Добавить»** чтобы добавить новые строки для ввода данных.\
    Пункты меню имеют особый формат.\
    Знак **«#»** в начале строки определяет Категорию с входящими в неё подпунктами. Все строки добавленные ниже определяют подпункты Категории.\
    Знак **«|»** разделяет название пункта и его описание.\
    Готовая структура может выглядеть, например, так:

    ```
    #Категория 1
    Пункт 1.1|Описание пункта 1.1
    Пункт 1.2|Описание пункта 1.2
    Пункт 1.3|Описание пункта 1.3
    #Категория 2
    Пункт 2.1|Описание пункта 2.1
    Пункт 2.2|Описание пункта 2.2
    Пункт 2.3|Описание пункта 2.3
    #Категория 3
    Пункт 3.1|Описание пункта 3.1
    Пункт 3.2|Описание пункта 3.2
    Пункт 3.3|Описание пункта 3.3
    ```
8. В поле **«Ожидать ответ сообщения»** выберите **«Да»,** если хотите дождаться ответа пользователя и использовать его выбор значения списка в дальнейших сценариях автоматизации или **«Нет»,** если в этом нет необходимости

Остальные настройки можно оставить по умолчанию.

<figure><img src="../../.gitbook/assets/image (812).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../.gitbook/assets/image (88).png" alt=""><figcaption></figcaption></figure>

Нажмите на кнопку «СОХРАНИТЬ»

Если в поле **«Ожидать ответ сообщения»** вы выбрали **«Да»,** ответ пользователя (выбранное им значение списка) можно получить в дополнительных результатах активити «\[OLChat — Чаты и Группы WhatsApp] Отправка сообщения со списком выбора».

<figure><img src="../../.gitbook/assets/image (2) (1) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

{% hint style="info" %}
Сообщение, полученное в WhatsApp имеет такой вид:
{% endhint %}

<figure><img src="../../.gitbook/assets/image (733).png" alt=""><figcaption></figcaption></figure>

При клике на Название происходит переход к списку, который имеет следующий вид:

<figure><img src="../../.gitbook/assets/image (559).png" alt=""><figcaption></figcaption></figure>

{% hint style="success" %}
Также следует помнить о том, что для одной сущности вы можете запустить не более 2-х бизнес-процессов одновременно. Подробнее в статье от Битрикс24 [Ограничение на запуск процессов](https://helpdesk.bitrix24.ru/open/5671433/)
{% endhint %}
