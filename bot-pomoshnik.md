# Бот-помощник

Для расширения функциональных возможностей чата с клиентом, можно подключить и настроить бота-помощника OLChat. Бот обладает следующими функциями:

* Обновление изображения контакта при изменении
* Изменение заголовков чатов по шаблону
* Привязка аналитики в поле CRM
* Установка бота, которому передаётся управление после бота OLChat
* [upravlenie-sostavom-uchastnikov-grupp-s-pomoshyu-komand-v-chate.md](gruppovye-chaty/upravlenie-sostavom-uchastnikov-grupp-s-pomoshyu-komand-v-chate.md "mention")

### Установка бота

Для включения и настройки бота-помощника в левом меню портала войдите в приложение **OLChat - Чаты и группы — (нажмите на название коннектора) — Настройка бота-помощника.** Нажмите на кнопку «УСТАНОВИТЬ».

<figure><img src=".gitbook/assets/image (414).png" alt=""><figcaption></figcaption></figure>

### Настройка бота

После установки, вы увидите сообщение: «Бот OLChat установлен на линии». Произведите дальнейшую настройку Бота OLChat:

<figure><img src=".gitbook/assets/image (394).png" alt=""><figcaption></figcaption></figure>

1. Установите галочку «Обновлять изображение контакта при изменении» в активное положение, если хотите, чтобы при начале нового диалога с клиентом производилась установка и обновление изображения контакта клиента в CRM из его профиля WhatsApp.
2. Настройка «Шаблон названия чата позволяет» автоматически переименовывать чат открытой линии по заранее подготовленному шаблону. В названии можно использовать параметры. Чтобы выбрать параметр нажмите на синюю кнопку с названием параметра. Выбранный параметр подставится в строку с названием шаблона.
3. Настройка «Привязать параметр аналитики к полю CRM» позволяет передавать параметры аналитики Roistat, ClientID, UserID и т.д в любое строковое пользовательское поле. Необходимо создать поле заранее и в выпадающем списке выбрать то поле лида, в которое необходимо записывать параметры аналитики.
4. Если в чате отрытой линии вы используете других ботов, в настройке «Бот, которому передаётся управление после бота OLChat» в выпадающем списке выберите бота, который начнёт работу после бота OLChat.

Также, для корректной работы чат-бота, рекомендуем перейти в открытую линию, которая подключена к данному коннектору и в разделе Чат-боты установить следующие оптимальные настройки, как показано на скриншоте ниже:

<figure><img src=".gitbook/assets/image (390).png" alt=""><figcaption></figcaption></figure>

Чтобы выключить бота OLChat необходимо перейти в настройки открытой линии, которая подключена к данному коннектору и в разделе Чат-боты снять галочку «При обращении клиента назначить ответственным чат-бота». Сохраните настройку. Бот OLChat будет отключен.

![](<.gitbook/assets/image (124).png>)

### Описание параметров бота

<figure><img src=".gitbook/assets/image (475).png" alt=""><figcaption></figcaption></figure>

* \[LINE] = Название линии
* \[LINE\_ID] = Номер линии
* \[CONNECTOR] = Название коннектора
* \[PHONE] = Номер телефона
* \[COMPANY] = Название компании
* \[NAME] = Имя из Контакта или Лида
* \[LAST\_NAME] = Фамилия из Контакта или Лида
* \[DIALOG] = Название диалога в WhatsApp
* \[CHAT\_ID] = ID чата в Битрикс24
* \[STATUS\_NAME] = Название стадии из лида (статус лида)
* \[STAGE\_NAME] = Название стадии из сделки (стадия сделки)
* \[DATETIME:<формат>] = Текущее время на момент создания (%Y-%m-%D %H:%M:%S)

### Добавление пользовательских полей в шаблон названия чата

Кроме базовых параметров перечисленных в виде кнопок под строкой создания шаблона, присутствует поддержка расширенных параметров для более гибкой настройки и добавления пользовательских полей в шаблон названия чата:

* \[LEAD:\<id\_параметра>]
* \[DEAL:\<id\_параметра>]
* \[CONTACT:\<id\_параметра>]
* \[COMPANY:\<id\_параметра>]

В этом случае в качестве \<id\_параметра> может выступать ID поля одной из сущностей CRM:

* LEAD – из лидов
* DEAL – из сделок
* CONTACT – из контактов
* COMPANY – из компаний

При использовании таких параметров, в шаблон будет подставлено значение указанного вами поля. Чтобы узнать ID поля, значение из которого вы хотите отобразить в шаблоне, на вашем портале необходимо перейти по адресу: **CRM — Настройки — Настройки CRM — Настройки форм и отчётов — Пользовательские поля — Сущность CRM: Лид|Сделка|Контакт|Компания — Список полей.** Выберите необходимое поле и откройте его в режиме редактирования. В браузере в строке ссылки будет указан ID этого поля. Скопируйте его и вставьте в шаблон на место \<id\_параметра>.

<figure><img src=".gitbook/assets/image (87).png" alt=""><figcaption></figcaption></figure>

Итоговая конструкция для подстановки в шаблон, может выглядеть, например, так: **\[DEAL:UF\_CRM\_5D775B5517E8D]**

{% hint style="warning" %}
Не рекомендуем использовать в качестве параметра такие поля из CRM, как: Телефон, E-mail, Мессенджер, Комментарий, поля привязки к сущности (будет отображаться ID сущности), Поля виджетов других приложений и множественные поля. При использовании данных полей отображение их в шаблоне может быть некорректным.
{% endhint %}
